!function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):(e='undefined'!=typeof globalThis?globalThis:e||self).jarallax=t()}(this,function(){'use strict';function e(e){'complete'===document.readyState||'interactive'===document.readyState?e():document.addEventListener('DOMContentLoaded',e,{capture:!0,once:!0,passive:!0})}let t;var n=t='undefined'!=typeof window?window:'undefined'!=typeof global?global:'undefined'!=typeof self?self:{},r={type:'scroll',speed:.5,containerClass:'jarallax-container',imgSrc:null,imgElement:'.jarallax-img',imgSize:'cover',imgPosition:'50% 50%',imgRepeat:'no-repeat',keepImg:!1,elementInViewport:null,zIndex:-100,disableParallax:!1,onScroll:null,onInit:null,onDestroy:null,onCoverImage:null,videoClass:'jarallax-video',videoSrc:null,videoStartTime:0,videoEndTime:0,videoVolume:0,videoLoop:!0,videoPlayOnlyVisible:!0,videoLazyLoading:!0,disableVideo:!1,onVideoInsert:null,onVideoWorkerInit:null};var i=n['navigator'];const o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(i.userAgent);let a,s,l;function m(){a=n.innerWidth||document.documentElement.clientWidth,s=o?(!l&&document.body&&((l=document.createElement('div')).style.cssText='position: fixed; top: -9999px; left: 0; height: 100vh; width: 0;',document.body.appendChild(l)),(l?l.clientHeight:0)||n.innerHeight||document.documentElement.clientHeight):n.innerHeight||document.documentElement.clientHeight}function u(){return{width:a,height:s}}m(),n.addEventListener('resize',m),n.addEventListener('orientationchange',m),n.addEventListener('load',m),e(()=>{m()});const p=[];function c(){if(p.length){const{width:a,height:s}=u();p.forEach((e,t)=>{var i,o,{instance:e,oldData:n}=e;e.isVisible()&&(i={width:(i=e.$item.getBoundingClientRect()).width,height:i.height,top:i.top,bottom:i.bottom,wndW:a,wndH:s},n=(o=!n||n.wndW!==i.wndW||n.wndH!==i.wndH||n.width!==i.width||n.height!==i.height)||!n||n.top!==i.top||n.bottom!==i.bottom,p[t].oldData=i,o&&e.onResize(),n)&&e.onScroll()}),n.requestAnimationFrame(c)}}const d=new n.IntersectionObserver(e=>{e.forEach(e=>{e.target.jarallax.isElementInViewport=e.isIntersecting})},{rootMargin:'50px'});const g=n['navigator'];let f=0;class h{constructor(e,t){const i=this,o=(i.instanceID=f,f+=1,i.$item=e,i.defaults={...r},i.$item.dataset||{}),n={};if(Object.keys(o).forEach(e=>{var t=e.substr(0,1).toLowerCase()+e.substr(1);t&&void 0!==i.defaults[t]&&(n[t]=o[e])}),i.options=i.extend({},i.defaults,n,t),i.pureOptions=i.extend({},i.options),Object.keys(i.options).forEach(e=>{'true'===i.options[e]?i.options[e]=!0:'false'===i.options[e]&&(i.options[e]=!1)}),i.options.speed=Math.min(2,Math.max(-1,parseFloat(i.options.speed))),'string'==typeof i.options.disableParallax&&(i.options.disableParallax=new RegExp(i.options.disableParallax)),i.options.disableParallax instanceof RegExp){const s=i.options.disableParallax;i.options.disableParallax=()=>s.test(g.userAgent)}if('function'!=typeof i.options.disableParallax&&(i.options.disableParallax=()=>!1),'string'==typeof i.options.disableVideo&&(i.options.disableVideo=new RegExp(i.options.disableVideo)),i.options.disableVideo instanceof RegExp){const l=i.options.disableVideo;i.options.disableVideo=()=>l.test(g.userAgent)}'function'!=typeof i.options.disableVideo&&(i.options.disableVideo=()=>!1);let a=i.options.elementInViewport;a&&'object'==typeof a&&void 0!==a.length&&([a]=a),a instanceof Element||(a=null),i.options.elementInViewport=a,i.image={src:i.options.imgSrc||null,$container:null,useImgTag:!1,position:'fixed'},i.initImg()&&i.canInitParallax()&&i.init()}css(e,t){return i=e,'string'==typeof(o=t)?n.getComputedStyle(i).getPropertyValue(o):(Object.keys(o).forEach(e=>{i.style[e]=o[e]}),i);var i,o}extend(e,...t){return[i,...o]=[e,...t],i=i||{},Object.keys(o).forEach(t=>{o[t]&&Object.keys(o[t]).forEach(e=>{i[e]=o[t][e]})}),i;var i,o}getWindowData(){var{width:e,height:t}=u();return{width:e,height:t,y:document.documentElement.scrollTop}}initImg(){var e=this;let t=e.options.imgElement;return(t=t&&'string'==typeof t?e.$item.querySelector(t):t)instanceof Element||(e.options.imgSrc?(t=new Image).src=e.options.imgSrc:t=null),t&&(e.options.keepImg?e.image.$item=t.cloneNode(!0):(e.image.$item=t,e.image.$itemParent=t.parentNode),e.image.useImgTag=!0),!(!e.image.$item&&(null===e.image.src&&(e.image.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',e.image.bgImage=e.css(e.$item,'background-image')),!e.image.bgImage||'none'===e.image.bgImage))}canInitParallax(){return!this.options.disableParallax()}init(){var e,t=this,i={position:'absolute',top:0,left:0,width:'100%',height:'100%',overflow:'hidden'};let o={pointerEvents:'none',transformStyle:'preserve-3d',backfaceVisibility:'hidden'};t.options.keepImg||((e=t.$item.getAttribute('style'))&&t.$item.setAttribute('data-jarallax-original-styles',e),t.image.useImgTag&&(e=t.image.$item.getAttribute('style'))&&t.image.$item.setAttribute('data-jarallax-original-styles',e)),'static'===t.css(t.$item,'position')&&t.css(t.$item,{position:'relative'}),'auto'===t.css(t.$item,'z-index')&&t.css(t.$item,{zIndex:0}),t.image.$container=document.createElement('div'),t.css(t.image.$container,i),t.css(t.image.$container,{'z-index':t.options.zIndex}),'fixed'===this.image.position&&t.css(t.image.$container,{'-webkit-clip-path':'polygon(0 0, 100% 0, 100% 100%, 0 100%)','clip-path':'polygon(0 0, 100% 0, 100% 100%, 0 100%)'}),t.image.$container.setAttribute('id','jarallax-container-'+t.instanceID),t.options.containerClass&&t.image.$container.setAttribute('class',t.options.containerClass),t.$item.appendChild(t.image.$container),t.image.useImgTag?o=t.extend({'object-fit':t.options.imgSize,'object-position':t.options.imgPosition,'max-width':'none'},i,o):(t.image.$item=document.createElement('div'),t.image.src&&(o=t.extend({'background-position':t.options.imgPosition,'background-size':t.options.imgSize,'background-repeat':t.options.imgRepeat,'background-image':t.image.bgImage||`url("${t.image.src}")`},i,o))),'opacity'!==t.options.type&&'scale'!==t.options.type&&'scale-opacity'!==t.options.type&&1!==t.options.speed||(t.image.position='absolute'),'fixed'===t.image.position&&(e=function(e){for(var t=[];null!==e.parentElement;)1===(e=e.parentElement).nodeType&&t.push(e);return t}(t.$item).filter(e=>{var e=n.getComputedStyle(e),t=e['-webkit-transform']||e['-moz-transform']||e.transform;return t&&'none'!==t||/(auto|scroll)/.test(e.overflow+e['overflow-y']+e['overflow-x'])}),t.image.position=e.length?'absolute':'fixed'),o.position=t.image.position,t.css(t.image.$item,o),t.image.$container.appendChild(t.image.$item),t.onResize(),t.onScroll(!0),t.options.onInit&&t.options.onInit.call(t),'none'!==t.css(t.$item,'background-image')&&t.css(t.$item,{'background-image':'none'}),i=t,p.push({instance:i}),1===p.length&&n.requestAnimationFrame(c),d.observe(i.options.elementInViewport||i.$item)}destroy(){var i,e,t=this,o=(i=t,p.forEach((e,t)=>{e.instance.instanceID===i.instanceID&&p.splice(t,1)}),d.unobserve(i.options.elementInViewport||i.$item),t.$item.getAttribute('data-jarallax-original-styles'));t.$item.removeAttribute('data-jarallax-original-styles'),o?t.$item.setAttribute('style',o):t.$item.removeAttribute('style'),t.image.useImgTag&&(e=t.image.$item.getAttribute('data-jarallax-original-styles'),t.image.$item.removeAttribute('data-jarallax-original-styles'),e?t.image.$item.setAttribute('style',o):t.image.$item.removeAttribute('style'),t.image.$itemParent)&&t.image.$itemParent.appendChild(t.image.$item),t.image.$container&&t.image.$container.parentNode.removeChild(t.image.$container),t.options.onDestroy&&t.options.onDestroy.call(t),delete t.$item.jarallax}coverImage(){var e=this,t=u()['height'],i=e.image.$container.getBoundingClientRect(),o=i.height,n=e.options['speed'],a='scroll'===e.options.type||'scroll-opacity'===e.options.type;let s=0,l=o,r=0;return a&&(n<0?(s=n*Math.max(o,t),t<o&&(s-=n*(o-t))):s=n*(o+t),1<n?l=Math.abs(s-t):n<0?l=s/n+Math.abs(s):l+=(t-o)*(1-n),s/=2),e.parallaxScrollDistance=s,r=a?(t-l)/2:(o-l)/2,e.css(e.image.$item,{height:l+'px',marginTop:r+'px',left:'fixed'===e.image.position?i.left+'px':'0',width:i.width+'px'}),e.options.onCoverImage&&e.options.onCoverImage.call(e),{image:{height:l,marginTop:r},container:i}}isVisible(){return this.isElementInViewport||!1}onScroll(e){var i=this;if(e||i.isVisible()){var e=u()['height'],o=i.$item.getBoundingClientRect(),n=o.top,a=o.height,s={},l=Math.max(0,n),r=Math.max(0,a+n),m=Math.max(0,-n),p=Math.max(0,n+a-e),c=Math.max(0,a-(n+a-e)),d=Math.max(0,-n+e-a),g=1-(e-n)/(e+a)*2;let t=1;if(a<e?t=1-(m||p)/a:r<=e?t=r/e:c<=e&&(t=c/e),'opacity'!==i.options.type&&'scale-opacity'!==i.options.type&&'scroll-opacity'!==i.options.type||(s.transform='translate3d(0,0,0)',s.opacity=t),'scale'===i.options.type||'scale-opacity'===i.options.type){let e=1;i.options.speed<0?e-=i.options.speed*t:e+=i.options.speed*(1-t),s.transform=`scale(${e}) translate3d(0,0,0)`}if('scroll'===i.options.type||'scroll-opacity'===i.options.type){let e=i.parallaxScrollDistance*g;'absolute'===i.image.position&&(e-=n),s.transform=`translate3d(0,${e}px,0)`}i.css(i.image.$item,s),i.options.onScroll&&i.options.onScroll.call(i,{section:o,beforeTop:l,beforeTopEnd:r,afterTop:m,beforeBottom:p,beforeBottomEnd:c,afterBottom:d,visiblePercent:t,fromViewportCenter:g})}}onResize(){this.coverImage()}}function b(e,t,...i){var o=(e=('object'==typeof HTMLElement?e instanceof HTMLElement:e&&'object'==typeof e&&null!==e&&1===e.nodeType&&'string'==typeof e.nodeName)?[e]:e).length;let n=0,a;for(n;n<o;n+=1)if('object'==typeof t||void 0===t?e[n].jarallax||(e[n].jarallax=new h(e[n],t)):e[n].jarallax&&(a=e[n].jarallax[t].apply(e[n].jarallax,i)),void 0!==a)return a;return e}b.constructor=h;const y=n.jQuery;if(void 0!==y){i=function(...e){Array.prototype.unshift.call(e,this);e=b.apply(n,e);return'object'!=typeof e?e:this};i.constructor=b.constructor;const x=y.fn.jarallax;y.fn.jarallax=i,y.fn.jarallax.noConflict=function(){return y.fn.jarallax=x,this}}return e(()=>{b(document.querySelectorAll('[data-jarallax]'))}),b});
//# sourceMappingURL=jarallax.min.js.map