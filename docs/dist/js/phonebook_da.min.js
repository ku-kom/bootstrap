!function(p){var e,f,_,S,E,k,R,O=p('#phoneform'),F=p('#box'),a=(p('#emp'),p('#soge')),b=p('#feedback'),w=b.next(p('.ku-loading')),d=p('#reset'),L=(p('#lang').val(),0),i=p('.pagination'),P=[],y=[],n=0;p('#go-find').on('click',function(t){t.preventDefault(),b.html(''),F.html(''),p.trim(a.val()).length?O.trigger('submit'):(a.focus(),b.append('<div class="alert alert-danger" role="alert" aria-atomic="true">Angiv s&oslash;geord<div>'),d.addClass('inactive'))}),p(d).on('click',function(t){a.focus(),d.addClass('inactive'),b.html(''),F.html(''),i.twbsPagination('destroy')}),a.keyup(function(){''==p(this).val()?d.addClass('inactive'):d.removeClass('inactive')}),O.on('submit',function(t){t.preventDefault(),w.show(),p.ajax({url:'https://www2.adm.ku.dk/selv/pls/!app_tlfbog_v2.soeg',data:'format=json&startrecord=0&recordsperpage=100&searchstring='+encodeURIComponent(a.val())+'&env=om',method:'post',jsonp:!1,dataType:'json'}).done(function(t){0<(y=(t.root||{}).employees||[]).length&&p.fn.twbsPagination?(L=y.length,n=Math.ceil(L/10),d.removeClass('inactive'),i.twbsPagination('destroy'),e()):(w.hide(),b.append('<div class="alert alert-warning" role="alert" aria-atomic="true">Ingen resultater fundet.<div>'))}).fail(function(t,e,a){console.log(t),w.hide(),b.append('<div class="alert alert-danger" role="alert" aria-atomic="true">Fejl i kommunikationen med webservicen - prøv igen senere.<div>')}),e=function(){i.show();var t=!0===window.matchMedia('(max-width: 767px)').matches?3:5;i.twbsPagination({totalPages:n,visiblePages:t,hideOnlyOnePage:!0,first:'Første',prev:'forrige',next:'Næste',last:'Sidste',onPageClick:function(t,e){k=10*Math.max(e-1,0),R=k+10,P=y.slice(k,R);var a=p('<ul class="media-list" id="emp" />');b.html(''),F.html(''),w.hide();for(var d=0;d<P.length;d++){var i,n=f(P[d].PERSON_FORNAVN)?'':'<dt>Navn</dt><dd><div class="ku-navn">'+P[d].PERSON_FORNAVN+' '+P[d].PERSON_EFTERNAVN+'</div></dd>',l=f(P[d].FOTOURL)?'':'<img class="media-object" src="'+P[d].FOTOURL+'" alt="">',s=f(P[d].ANSAT_UOFF_STIL_TEKST)?'':'<dt>Titel</dt><dd>'+P[d].ANSAT_UOFF_STIL_TEKST+'</dd>',o=f(P[d].STED_NAVN_SAMLET)?'':'<dt>Enhed/&shy;afdeling</dt><dd>'+P[d].STED_NAVN_SAMLET+'</dd>',r=f(P[d].ANSAT_FUNKTION)?'':'<dt>Funktion</dt><dd>'+P[d].ANSAT_FUNKTION+'</dd>',c=f(P[d].ANSAT_TLF_SEKR)?'':'<dt>Sekret&aelig;r</dt><dd>'+E(P[d].ANSAT_TLF_SEKR)+'</dd>',A=f(P[d].ANSAT_PURE_DK)?'':'<dt>Profil</dt><dd><a aria-label="Forskning og publikationer af '+P[d].PERSON_FORNAVN+' '+P[d].PERSON_EFTERNAVN+'" href="'+P[d].ANSAT_PURE_DK+'">Forskning og publikationer</a></dd>',u=f(P[d].ANSAT_WWW)?'':'<dt>Website</dt><dd>'+S(P[d].ANSAT_WWW)+'</dd>',m=f(P[d].ANSAT_ARB_EMAIL)?'':'<dt>E-mail</dt><dd>'+_(P[d].ANSAT_ARB_EMAIL)+'</dd>',g=f(P[d].ANSAT_MOBIL)?'':'<dt>Mobil</dt><dd>'+E(P[d].ANSAT_MOBIL)+'</dd>',v=f(P[d].ANSAT_ARB_TLF)?'':'<dt>Telefon</dt><dd>'+E(P[d].ANSAT_ARB_TLF)+'</dd>',N=f(P[d].ANSAT_ADRESSE)?'':'<dt>Adresse</dt><dd>'+P[d].ANSAT_ADRESSE+'</dd>',h=f(P[d].LOKATION)?'':'<dt>Lokation</dt><dd>'+P[d].LOKATION+'</dd>',T=f(P[d].BEMAERK)?'':'<dt>Bem&aelig;rk&shy;ninger</dt><dd>'+P[d].BEMAERK+'</dd>',l=((i=p('<li class="contact-list"/>')).append('<dl class="dl-horizontal"><div class="ku-result"><div class="contact-right">'+l+'</div>'+n+s+r+A+o+'</div><div class="ku-kontakt">'+m+g+v+c+u+N+h+T+'</div></dl>'),a.append(i),0===k?k+1:k),n=L<10||L<R?L:R,s=1<L?'resultater.':'resultat.';b.html('<div aria-atomic="true">Viser '+l+' til '+n+' ud af '+L+' '+s+'</div>')}F.append(a),p(document).on('click','.page-item',function(t){p('html, body').stop(),p('html, body').animate({scrollTop:p(O).offset().top},500),p(window).bind('mousewheel',function(){p('html, body').stop()})})}}),p('.page-item > a').attr('rel','nofollow')},_=function(t){return!0===/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/.test(t)?'<a class="ku-mail" href="mailto:'+t+'">'+t+'</a>':t},S=function(t){return!0===/(https?:\/\/[^\s]+)/g.test(t)?'<a href="'+t+'">'+t+'</a>':t},E=function(t){var e;return!0===/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g.test(t)?(e=[(t=(t=t.replace(/[^0-9+]+/g,'')).match(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im)?t:'+45'+t).slice(0,3),' ',t.slice(3,5),' ',t.slice(5,7),' ',t.slice(7,9),' ',t.slice(9)].join(''),'<a href="tel:'+t+'">'+e+'</a>'):t},f=function(t){return null==t||0===t.length}})}(jQuery);
//# sourceMappingURL=phonebook_da.min.js.map